### 协议说明与示例

#### 说明：
1. msgid根据public.h里面定义的枚举来设定
2. 嵌套的时候使用对象形式，不得使用字符串化的json

#### 1、注册请求

```json
{
    "msgid": 1100,
    "version": "1.0",
    "token": "",
    "data": {
        "device": "pc",
        "username": "zhangsan",
        "password": "加密密码"
    }
}
```

#### 注册响应

```json
{
    "msgid": 1101,
    "code": 0,
    "message": "OK",
    "data": {
        "userid": 123,
        "msg": "注册成功"
    }
}
```
### 以下请求，省略通用部分，只标注载荷部分，失败响应无载荷。根据返回的类型解析即可

#### 2、密码登录请求
```json
{
    "data": {
        "device": "pc",
        "userid": 123,
        "password": "加密密码"
    }
}
```
#### 密码登录成功响应
```json
{
    "data": {
        "token": "xxxxx",
        "friends": [
            {
                "userid": 1,
                "username": "lisi1",
                "state": "online"
            },
            {
                "userid": 2,
                "username": "lisi2",
                "state": "online"
            }
        ],
        "groups": [
            {
                "groupid": "1",
                "groupname": "bb",
                "groupdesc": "cc"
            },
            {
                "groupid": "2",
                "groupname": "bb",
                "groupdesc": "cc"
            }
        ],
    }
}
```


#### 3、以下为使用Token登录请求
```json
{
    "data": {
        "device": "pc",
    }
}
```

#### 响应
```json
{
    "data": {
        "friends": [
            {
                "userid": 1,
                "username": "lisi1",
                "state": "online"
            },
            {
                "userid": 2,
                "username": "lisi2",
                "state": "online"
            }
        ],
        "groups": [
            {
                "groupid": "1",
                "groupname": "bb",
                "groupdesc": "cc"
            },
            {
                "groupid": "2",
                "groupname": "bb",
                "groupdesc": "cc"
            }
        ],
        "offlinemsg": [
            {
                "msgid":1,
                "groupid": 1,//群聊离线消息就会有这个，非群聊则没有这个字段
                "userid": 1,
                "msg": "hello world"
            }
        ]
    }
}
```
#### 4、添加好友
```json
{
    "data": {
        "friendid": 1,
    }
}
```

#### 响应有两个，一个是回复响应，一个是好友端收到被添加的通知，客户端收到后加入自己的好友列表中

##### 发送端的响应
```json
{
    "data": {
        "friendid": 1,
        "friendname":"张三",
        "msg":"添加好友成功"
    }
}
```
##### 好友端的响应
```json
{
    "data": {
        "friendid": 2,
        "friendname":"李四",
        "msg":"被添加好友成功，对方是李四"
    }
}
```

#### 5、以下为私聊请求

```json
{
    "data": {
        "toid": 1,
        "msg": "hello world"
    }
}
```
#### 好友端收到的私聊响应
```json
{
    "data": {
        "userid": 1,
        "msg": "hello world"
    }
}
```

#### 6、以下为创建群组请求
```json
{
    "data": {
        "groupname": "我的群组",
        "groupdesc": "我的第二个群组"
    }
}
```
### 响应部分，返回加入的群组
```json
{
    "data": {
        "msg":"创建群组成功",
        "groupid": "1",
        "groupname": "bb",
        "groupdesc": "cc"
    }
}
```

#### 7、以下为加入群组请求

```json
{
    "data": {
        "groupid": 1
    }
}
```

### 响应部分
```json
{
    "data": {
        "msg": "加入群组成功",
        "groupid": "1",
        "groupname": "bb",
        "groupdesc": "cc"
    }
}
```

#### 8、群组聊天
```json
{
    "data": {
        "groupid": 1,
        "msg":"你好呀"
    }
}
```

#### 群组内所有成员收到消息,客户端查找本地群组名称后显示完整消息。
```json
{
    "data": {
        "offlinemsg": [
            {
                "msgid":1,
                "groupid": 1,//群聊离线消息就会有这个，非群聊则没有这个字段
                "userid": 1,
                "msg": "hello world"
            }
        ]
    }
}
```

